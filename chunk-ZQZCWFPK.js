import{a as k}from"./chunk-C3VOZNN7.js";import{a as D}from"./chunk-AWBXYETS.js";import"./chunk-QNCAHXZN.js";import{$a as m,Ea as C,Fb as I,Ga as l,La as c,Qa as h,Ua as x,Y as p,Z as g,_b as T,bc as y,db as r,eb as i,fb as s,gb as v,hb as E,ib as b,kb as S,lb as u,qb as _,rb as a,tb as f,vb as w}from"./chunk-GBA5LKQX.js";import"./chunk-EQDQRRRY.js";function U(o,e){if(o&1){let t=b();v(0),r(1,"h2",3),a(2,"Carnet Estudiantil"),i(),r(3,"div",4),s(4,"img",5),i(),r(5,"div",4)(6,"strong"),a(7,"Nombre:"),i(),a(8),s(9,"br"),r(10,"strong"),a(11,"C\xE9dula:"),i(),a(12),s(13,"br"),r(14,"strong"),a(15,"Secci\xF3n:"),i(),a(16),i(),r(17,"button",6),S("click",function(){p(t);let d=u();return g(d.onGenerarCarnet())}),s(18,"i",7),a(19," Descargar carnet (JPG) "),i(),E()}if(o&2){let t=u();l(4),m("src",t.fotoUrl,C),l(4),w(" ",t.estudiante.nombre," ",t.estudiante.apellido1," ",t.estudiante.apellido2,""),l(4),f(" ",t.estudiante.cedula,""),l(4),f(" ",t.estudiante.seccion," ")}}function M(o,e){o&1&&(r(0,"div",8),a(1,"No se pudo cargar los datos del estudiante. Por favor, contacte a la administraci\xF3n."),i())}var A=class o{constructor(e,t){this.authService=e;this.estudianteService=t}estudiante=null;fotoUrl="";ngOnInit(){let e=this.authService.getUsernameValue();e&&this.estudianteService.getByCedula(e).subscribe({next:t=>{this.estudiante=t,this.fotoUrl=t?.foto||""}})}onGenerarCarnet(){if(!this.estudiante)return;let e=document.createElement("canvas");e.width=600,e.height=350;let t=e.getContext("2d");if(t)if(t.fillStyle="#fffbe6",t.fillRect(0,0,e.width,e.height),this.fotoUrl){let n=new window.Image;n.onload=()=>{t.drawImage(n,30,40,120,160),this.drawTextAndDownload(t,e)},n.src=this.fotoUrl}else this.drawTextAndDownload(t,e)}drawTextAndDownload(e,t){if(!this.estudiante)return;e.font="bold 28px Arial",e.fillStyle="#333",e.fillText("Carnet Estudiantil",180,60),e.font="20px Arial",e.fillText("Nombre:",180,110),e.fillText(this.estudiante.nombre+" "+this.estudiante.apellido1+" "+this.estudiante.apellido2,270,110),e.fillText("C\xE9dula:",180,150),e.fillText(this.estudiante.cedula,270,150),e.fillText("Secci\xF3n:",180,190),e.fillText(this.estudiante.seccion,270,190);let n=document.createElement("a");n.download="carnet-estudiante.jpg",n.href=t.toDataURL("image/jpeg",.95),n.click()}static \u0275fac=function(t){return new(t||o)(c(D),c(k))};static \u0275cmp=h({type:o,selectors:[["app-estudiante-carnet"]],decls:4,vars:2,consts:[["errorBlock",""],[1,"container","py-5","text-center"],[4,"ngIf","ngIfElse"],[1,"mb-4"],[1,"mb-3"],["alt","Foto estudiante","width","120","height","120",1,"rounded","mb-2",3,"src"],[1,"btn","btn-warning","btn-lg","fw-bold",3,"click"],[1,"bi","bi-person-badge"],[1,"alert","alert-danger","mt-5"]],template:function(t,n){if(t&1&&(r(0,"div",1),x(1,U,20,6,"ng-container",2)(2,M,2,0,"ng-template",null,0,I),i()),t&2){let d=_(3);l(),m("ngIf",n.estudiante)("ngIfElse",d)}},dependencies:[y,T],styles:[".container[_ngcontent-%COMP%]{max-width:500px;margin:auto}img[_ngcontent-%COMP%]{border:2px solid #ccc}.btn-warning[_ngcontent-%COMP%]{background:linear-gradient(90deg,gold,#ffb300);border:none;color:#333}"]})};export{A as EstudianteCarnetComponent};
